# Анализ влияния Vulkan на FPS

**Профессиональное аналитическое исследование — Gear Games**

## Обзор исследования

Комплексный фреймворк для статистического анализа, разработанный для Gear Games с целью оценки влияния внедрения Vulkan API на производительность мобильных игр. Это production-ready решение использует строгую методологию парного статистического тестирования для выявления паттернов производительности на различных устройствах, что позволяет принимать обоснованные решения о платформо-специфичном развёртывании графического API.

**Бизнес-ценность:** Анализ напрямую влияет на технические решения по включению/отключению Vulkan на разных моделях устройств и семействах GPU, обеспечивая оптимальный игровой опыт и предотвращая деградацию производительности на специфичных конфигурациях оборудования.

**Примечание:** *Данный репозиторий содержит пример на синтетических данных, сохраняющий методологию анализа, используемую в production. Вся конфиденциальная информация клиентов заменена с сохранением статистических свойств и аналитической строгости.*

---

## Ключевые достижения

- **Проанализировано 1 298 игроков** с использованием методологии парного сравнения до/после
- **Выявлено 31 модель устройств** со стабильным улучшением FPS (>70% improvement rate)
- **Выявлено 37 моделей устройств**, требующих отката Vulkan (<30% improvement rate)
- **Классифицировано 10 семейств GPU** для включения Vulkan и **12 для исключения**
- **+6,99% улучшение минимального FPS** (статистически значимо, p<0,001) — критично для плавности геймплея
- **Автоматическая генерация отчётов** со статистическими тестами, сегментацией по устройствам/GPU и комплексными визуализациями

---

## Стек технологий

- **Python** — Основной язык программирования
- **Pandas & NumPy** — Манипуляция и агрегация данных
- **SciPy** — Парные t-тесты и проверка статистической значимости
- **Matplotlib & Seaborn** — Генерация профессиональных визуализаций
- **Статистический анализ** — Проверка гипотез, расчёт размера эффекта, доверительные интервалы

---

# Отчёт об анализе

**Дата анализа:** 2025-10-16 19:10:01

---

## Содержание

1. [Описание задачи](#описание-задачи)
2. [Методология исследования](#методология-исследования)
3. [Загрузка и подготовка данных](#загрузка-и-подготовка-данных)
4. [Общие результаты](#общие-результаты)
5. [Статистический анализ](#статистический-анализ)
6. [Анализ по устройствам](#анализ-по-устройствам)
7. [Анализ по GPU](#анализ-по-gpu)
8. [Визуализации](#визуализации)
9. [Выводы и рекомендации](#выводы-и-рекомендации)

---

## Описание задачи

### Контекст

Игрокам предлагалось пройти тест FPS:
- **До внедрения Vulkan**: Миссия 966
- **После внедрения Vulkan**: Миссия 967

### Цели анализа

1. Оценить общий эффект от внедрения Vulkan (улучшение или ухудшение FPS)
2. Определить списки устройств, для которых эффект стабильно положительный/отрицательный
3. Определить списки GPU, для которых эффект стабильно положительный/отрицательный

---

## Методология исследования

### Этап 1: Идентификация игроков для сравнения

**Подход:**
- Из всего датасета выделяются игроки, которые прошли тест ДО (миссия 966) и ПОСЛЕ (миссия 967) внедрения Vulkan
- Это обеспечивает парное сравнение (paired comparison), что критично для корректной оценки эффекта
- Игроки, прошедшие только один тест, исключаются из анализа

**Обоснование:**
- Парное сравнение устраняет индивидуальную вариативность игроков
- Позволяет изолировать эффект именно от внедрения Vulkan, а не от различий в навыках или поведении игроков

### Этап 2: Агрегация данных

**Подход:**
- Для каждого игрока могут быть множественные измерения в рамках одной миссии
- Используется медианное значение для агрегации данных по игроку
- Медиана выбрана вместо среднего для устойчивости к выбросам

**Метрики FPS:**
- `c_FpsAvg` - средний FPS за сессию
- `c_FpsAvgMin` - минимальный средний FPS (важен для оценки "просадок")
- `c_FpsAvgOnePercentile` - 1% перцентиль (показывает худшие 1% моментов)

### Этап 3: Расчет изменений

**Подход:**
- Для каждой метрики рассчитываются:
  - Абсолютное изменение: `Δ = FPS_after - FPS_before`
  - Процентное изменение: `Δ% = (Δ / FPS_before) × 100%`

**Критерии оценки изменений:**
- Для каждого игрока оцениваются 3 ключевые метрики:
  - Средний FPS (`c_FpsAvg`)
  - Минимальный FPS (`c_FpsAvgMin`)
  - 1% перцентиль FPS (`c_FpsAvgOnePercentile`)

- **Порог значимых изменений:** 1.0 FPS
  - Улучшение: Δ > 1.0 FPS
  - Без изменений: |Δ| ≤ 1.0 FPS  
  - Ухудшение: Δ < -1.0 FPS

- **Общая оценка игрока:**
  - **Улучшение**: если 2/3 метрик улучшились ИЛИ если 1/3 улучшилась + 2/3 без изменений
  - **Без изменений**: если 3/3 метрик без изменений
  - **Ухудшение**: во всех остальных случаях

### Этап 4: Статистический анализ

**Подход:**
- Применяется парный t-тест Стьюдента (paired t-test)
- Проверяется гипотеза: H0: среднее изменение = 0 vs H1: среднее изменение ≠ 0
- Уровень значимости: α = 0.05

**Обоснование:**
- Парный t-тест подходит для сравнения двух связанных выборок (до/после)
- p-value < 0.05 указывает на статистически значимое изменение

### Этап 5: Анализ по устройствам

**Подход:**
- Данные агрегируются по моделям устройств (`DeviceModel`)
- Для каждого устройства рассчитывается:
  - Количество игроков
  - Средние изменения ключевых метрик FPS
  - Процент игроков с улучшением (`improvement_rate`)

**Критерии фильтрации:**
- Анализируются только устройства с **минимум 3 игроками** (для статистической значимости)

**Критерии классификации:**
- **Стабильное улучшение**: improvement_rate > 70.0%
- **Стабильное ухудшение**: improvement_rate < 30.0%
- **Нейтральный эффект**: 30.0% ≤ improvement_rate ≤ 70.0%

### Этап 6: Анализ по GPU

**Подход:**
- Аналогично анализу по устройствам, но агрегация по GPU (`c_GraphicsDeviceName`)
- Применяются те же критерии фильтрации и классификации

**Обоснование:**
- Vulkan - это графический API, поэтому эффект может сильно зависеть от архитектуры GPU
- Важно выявить GPU, где Vulkan показывает лучшую/худшую оптимизацию

---
## Загрузка и подготовка данных

### Исходные данные

- **Источник:** `offer_fps.csv` и `client_info.csv`
- **Всего записей:** 6211
- **Записей до Vulkan (миссия 966):** 3777
- **Записей после Vulkan (миссия 967):** 2434

### Сопоставление игроков

- **Уникальных игроков до:** 1298
- **Уникальных игроков после:** 2077
- **Игроков, прошедших оба теста:** 1298

### Валидация пар

- **Валидных игроков (с Vulkan на миссии 967):** 1298

### Данные для анализа

- **Игроков в финальной выборке:** 1298
- **Записей до (matched):** 1349
- **Записей после (matched):** 1336

---
## Общие результаты

### Распределение эффекта

| Результат | Количество игроков | Процент |
|-----------|-------------------|---------|
| 🟢 Улучшение | 635 | 48.9% |
| 🟡 Без изменений | 91 | 7.0% |
| 🔴 Ухудшение | 572 | 44.1% |
| **Всего** | **1298** | **100.0%** |

![Общее распределение](../common/vulkan_fps_analysis/plots/overall_effect_pie.png)

### Статистика по ключевым метрикам

#### 1. Средний FPS (c_FpsAvg)

| Период | Среднее | Стд. откл. |
|--------|---------|-----------|
| До Vulkan | 75.18 | 20.49 |
| После Vulkan | 74.36 | 21.08 |
| **Изменение (Δ)** | **-0.82** | **11.30** |
| **Изменение (%)** | **-1.10%** | - |

#### 2. Минимальный FPS (c_FpsAvgMin)

| Период | Среднее | Стд. откл. |
|--------|---------|-----------|
| До Vulkan | 25.24 | 3.69 |
| После Vulkan | 27.00 | 4.75 |
| **Изменение (Δ)** | **1.76** | **2.67** |
| **Изменение (%)** | **6.99%** | - |

#### 3. 1% Перцентиль FPS (c_FpsAvgOnePercentile)

| Период | Среднее | Стд. откл. |
|--------|---------|-----------|
| До Vulkan | 41.85 | 12.49 |
| После Vulkan | 42.64 | 13.20 |
| **Изменение (Δ)** | **0.79** | **7.40** |
| **Изменение (%)** | **1.88%** | - |

---
## Статистический анализ

### Парный t-тест Стьюдента

Проверяется гипотеза о значимости изменения FPS после внедрения Vulkan.

**Нулевая гипотеза (H0):** Среднее изменение FPS = 0 (нет эффекта)  
**Альтернативная гипотеза (H1):** Среднее изменение FPS ≠ 0 (есть эффект)  
**Уровень значимости:** α = 0.05

#### Средний FPS

| Параметр | Значение |
|----------|----------|
| t-статистика | -2.6288 |
| p-value | 0.008670 |
| Направление | ↓ Ухудшение |
| Результат | ✅ **СТАТИСТИЧЕСКИ ЗНАЧИМО** |

#### Минимальный FPS

| Параметр | Значение |
|----------|----------|
| t-статистика | 23.7962 |
| p-value | 0.000000 |
| Направление | ↑ Улучшение |
| Результат | ✅ **СТАТИСТИЧЕСКИ ЗНАЧИМО** |

#### 1% Перцентиль FPS

| Параметр | Значение |
|----------|----------|
| t-статистика | 3.8276 |
| p-value | 0.000136 |
| Направление | ↑ Улучшение |
| Результат | ✅ **СТАТИСТИЧЕСКИ ЗНАЧИМО** |

### Интерпретация

- **p-value < 0.05** означает, что изменение статистически значимо (вероятность случайности < 5%)
- **t-статистика > 0** указывает на положительное изменение (улучшение)
- **t-статистика < 0** указывает на отрицательное изменение (ухудшение)

---
## Анализ по устройствам

### Методология

- **Минимальное количество игроков для анализа:** 3
- **Критерий стабильного улучшения:** >70.0% игроков показали улучшение
- **Критерий стабильного ухудшения:** <30.0% игроков показали улучшение

### 🟢 Анализ по устройствам со стабильным улучшением

**Количество:** 31

| # | Название | Игроков | % Улучш. | До (AVG) | После (AVG) | Δ (AVG) |
|---|---|---|---|---|---|---|
| 1 | samsung SM-S928B | 19 | 78.9% | 89.3 | 92.4 | +3.13 |
| 2 | TECNO TECNO LH7n | 11 | 72.7% | 72.0 | 75.5 | +3.55 |
| 3 | Xiaomi 22101320G | 11 | 81.8% | 74.5 | 78.7 | +4.27 |
| 4 | TECNO TECNO LI6 | 10 | 90.0% | 69.0 | 73.7 | +4.70 |
| 5 | Xiaomi 24069PC21G | 8 | 75.0% | 103.8 | 107.5 | +3.75 |
| 6 | Xiaomi 23049PCD8G | 8 | 87.5% | 96.9 | 94.8 | -2.12 |
| 7 | samsung SM-A715F | 7 | 100.0% | 67.4 | 72.0 | +4.57 |
| 8 | samsung SM-A556B | 7 | 71.4% | 82.9 | 82.7 | -0.14 |
| 9 | samsung SM-S938B | 7 | 100.0% | 112.7 | 112.9 | +0.14 |
| 10 | Xiaomi 23053RN02Y | 7 | 85.7% | 40.7 | 45.3 | +4.57 |
| 11 | samsung SM-S721B | 7 | 71.4% | 104.0 | 105.4 | +1.43 |
| 12 | samsung SM-S918B | 6 | 83.3% | 78.7 | 88.8 | +10.17 |
| 13 | HONOR REA-NX9 | 6 | 83.3% | 84.3 | 87.0 | +2.67 |
| 14 | Xiaomi 23113RKC6G | 5 | 80.0% | 114.0 | 102.8 | -11.20 |
| 15 | samsung SM-F956B | 4 | 75.0% | 120.8 | 121.8 | +1.00 |
| 16 | TECNO TECNO LG7n | 4 | 100.0% | 74.0 | 74.0 | +0.00 |
| 17 | samsung SM-S711B | 4 | 75.0% | 78.5 | 78.0 | -0.50 |
| 18 | INFINIX Infinix X6833B | 4 | 75.0% | 68.5 | 68.8 | +0.25 |
| 19 | Xiaomi 23021RAAEG | 4 | 75.0% | 62.0 | 61.5 | -0.50 |
| 20 | INFINIX Infinix X6871 | 4 | 75.0% | 79.0 | 79.0 | +0.00 |

### 🔴 Анализ по устройствам со стабильным ухудшением

**Количество:** 37

| # | Название | Игроков | % Улучш. | До (AVG) | После (AVG) | Δ (AVG) |
|---|---|---|---|---|---|---|
| 1 | Xiaomi 2412DPC0AG | 9 | 0.0% | 107.8 | 96.8 | -11.00 |
| 2 | Xiaomi 2312FPCA6G | 8 | 25.0% | 76.9 | 70.5 | -6.38 |
| 3 | samsung SM-A346E | 7 | 14.3% | 92.9 | 87.9 | -5.00 |
| 4 | Xiaomi 23043RP34G | 7 | 28.6% | 96.6 | 95.1 | -1.43 |
| 5 | HONOR ALI-NX1 | 7 | 28.6% | 78.7 | 78.7 | +0.00 |
| 6 | samsung SM-A515F | 7 | 28.6% | 62.9 | 60.4 | -2.43 |
| 7 | realme RMX3834 | 6 | 16.7% | 57.0 | 58.7 | +1.67 |
| 8 | Xiaomi 24090RA29G | 6 | 16.7% | 100.5 | 89.8 | -10.67 |
| 9 | Xiaomi 2406APNFAG | 5 | 0.0% | 125.4 | 123.8 | -1.60 |
| 10 | samsung SM-X200 | 5 | 0.0% | 64.4 | 60.4 | -4.00 |
| 11 | Xiaomi 23073RPBFG | 5 | 0.0% | 65.6 | 62.2 | -3.40 |
| 12 | TECNO TECNO KI7 | 5 | 20.0% | 61.6 | 57.0 | -4.60 |
| 13 | Xiaomi 22126RN91Y | 4 | 25.0% | 51.5 | 48.5 | -3.00 |
| 14 | HONOR CRT-NX1 | 4 | 25.0% | 72.2 | 74.2 | +2.00 |
| 15 | realme RMX3195 | 4 | 0.0% | 56.2 | 48.2 | -8.00 |
| 16 | TECNO TECNO LI7 | 4 | 25.0% | 78.2 | 67.8 | -10.50 |
| 17 | samsung SM-A137F | 4 | 0.0% | 64.8 | 56.5 | -8.25 |
| 18 | samsung SM-A336E | 4 | 25.0% | 82.8 | 73.2 | -9.50 |
| 19 | realme RMX3871 | 4 | 0.0% | 69.4 | 65.8 | -3.62 |
| 20 | HONOR NTH-NX9 | 4 | 25.0% | 98.8 | 90.8 | -8.00 |

### TOP-20 анализ по устройствам по количеству игроков

![TOP-20 анализ по устройствам](../common/vulkan_fps_analysis/plots/top_devices_improvement_rate.png)

---
## Анализ по GPU

### Методология

- **Минимальное количество игроков для анализа:** 3
- **Критерий стабильного улучшения:** >70.0% игроков показали улучшение
- **Критерий стабильного ухудшения:** <30.0% игроков показали улучшение

### 🟢 Анализ по GPU со стабильным улучшением

**Количество:** 10

| # | Название | Игроков | % Улучш. | До (AVG) | После (AVG) | Δ (AVG) |
|---|---|---|---|---|---|---|
| 1 | Adreno (TM) 750 | 36 | 86.1% | 95.6 | 98.0 | +2.46 |
| 2 | Adreno (TM) 730 | 28 | 75.0% | 82.9 | 86.9 | +4.05 |
| 3 | Adreno (TM) 830 | 25 | 72.0% | 99.0 | 96.4 | -2.64 |
| 4 | Adreno (TM) 735 | 14 | 78.6% | 94.3 | 96.6 | +2.36 |
| 5 | Mali-G610 MC6 | 13 | 84.6% | 75.6 | 74.8 | -0.85 |
| 6 | Adreno (TM) 725 | 11 | 90.9% | 91.8 | 90.5 | -1.36 |
| 7 | ANGLE (Samsung Xclipse 920) on Vulkan 1.3.279 | 9 | 88.9% | 78.4 | 84.4 | +6.00 |
| 8 | Adreno (TM) 720 | 5 | 80.0% | 78.8 | 79.0 | +0.20 |
| 9 | PowerVR Rogue GE8320 | 5 | 80.0% | 37.6 | 73.6 | +36.00 |
| 10 | Adreno (TM) 612 | 3 | 100.0% | 69.3 | 72.3 | +3.00 |

### 🔴 Анализ по GPU со стабильным ухудшением

**Количество:** 12

| # | Название | Игроков | % Улучш. | До (AVG) | После (AVG) | Δ (AVG) |
|---|---|---|---|---|---|---|
| 1 | Mali-G57 | 62 | 27.4% | 60.7 | 58.7 | -2.00 |
| 2 | Mali-G68 | 33 | 27.3% | 81.0 | 75.9 | -5.09 |
| 3 | Mali-G72 | 23 | 26.1% | 62.5 | 59.0 | -3.48 |
| 4 | Mali-G51 | 14 | 21.4% | 59.7 | 60.6 | +0.86 |
| 5 | Mali-G720 MC7 | 10 | 0.0% | 104.9 | 94.9 | -10.00 |
| 6 | Mali-G71 | 6 | 16.7% | 51.3 | 42.0 | -9.33 |
| 7 | PowerVR Rogue GE8322 | 6 | 16.7% | 38.3 | 37.3 | -1.00 |
| 8 | Mali-G72 MP3 | 4 | 25.0% | 66.5 | 63.2 | -3.25 |
| 9 | Mali-G57 MC3 | 4 | 0.0% | 59.2 | 54.0 | -5.25 |
| 10 | Mali-G710 MC10 | 4 | 25.0% | 78.2 | 78.8 | +0.50 |
| 11 | Mali-G715-Immortalis MC11 | 3 | 0.0% | 79.0 | 78.7 | -0.33 |
| 12 | PowerVR B-Series BXM-8-256 | 3 | 0.0% | 75.7 | 67.3 | -8.33 |

### TOP-20 анализ по gpu по количеству игроков

![TOP-20 анализ по gpu](../common/vulkan_fps_analysis/plots/top_gpu_improvement_rate.png)

---
## Визуализации

### Распределение изменений FPS

![Распределение изменений](../common/vulkan_fps_analysis/plots/fps_delta_distribution.png)

**Интерпретация:**
- Гистограммы показывают распределение изменений для трех ключевых метрик
- Красная пунктирная линия (x=0) разделяет улучшение и ухудшение
- Смещение распределения вправо от нуля указывает на общее улучшение
- Смещение влево - на ухудшение

### Сравнение до/после (Box Plot)

![Box Plot до/после](../common/vulkan_fps_analysis/plots/fps_before_after_boxplot.png)

**Интерпретация:**
- Box plot показывает медиану, квартили и выбросы
- Позволяет визуально оценить изменение центральной тенденции и разброса
- Зеленая линия внутри боксов - среднее значение

### Scatter Plot: До vs После

![Scatter Plot](../common/vulkan_fps_analysis/plots/fps_before_after_scatter.png)

**Интерпретация:**
- Три графика для сравнения: Средний FPS, Минимальный FPS, 1% Перцентиль FPS
- Каждая точка - один игрок
- Черная пунктирная линия - линия "без изменений" (y=x)
- Зеленые точки - улучшение по соответствующей метрике (Δ > 1.0 FPS)
- Оранжевые точки - без изменений по соответствующей метрике (|Δ| ≤ 1.0 FPS)
- Красные точки - ухудшение по соответствующей метрике (Δ < -1.0 FPS)
- Цвет точки определяется независимо для каждой метрики (по её дельте)

---
## Выводы и рекомендации

### Общие выводы

**Общий эффект от внедрения Vulkan: НЕОДНОЗНАЧНЫЙ**

Анализ выявил неоднородное влияние Vulkan на различные аппаратные конфигурации:

1. **Охват аудитории:**
   - В анализе участвовало 1 298 игроков
   - 635 игроков (48.9%) показали улучшение FPS
   - 91 игроков (7.0%) остались без изменений
   - 572 игроков (44.1%) показали ухудшение FPS

2. **Ключевые результаты по метрикам:**
   - Средний FPS: -0.82 FPS (-1.10%) — небольшое ухудшение
   - Минимальный FPS: +1.76 FPS (+6.99%) — **значительное улучшение**
   - 1% Перцентиль FPS: +0.79 FPS (+1.88%) — улучшение
   
   *Примечание: процентное изменение = (дельта) / (значение до) × 100%*

3. **Статистическая значимость:**
   - Средний FPS: статистически значимое снижение (p=0.008670)
   - Минимальный FPS: статистически значимое улучшение (p<0.001)
   - 1% Перцентиль FPS: статистически значимое улучшение (p=0.000136)

### Результаты сегментации по устройствам и GPU

Анализ выделил три различные категории устройств:

**Устройства, требующие включения Vulkan:**
- Демонстрируют стабильное улучшение FPS
- Примеры: samsung SM-S928B, Adreno (TM) 750, Adreno (TM) 730
- Рекомендуемое действие: **Включить Vulkan**

**Устройства, требующие отключения Vulkan:**
- Демонстрируют стабильную деградацию FPS
- Примеры: Xiaomi 2412DPC0AG, Mali-G57, Mali-G68
- Рекомендуемое действие: **Отключить Vulkan**

**Категория компромиссов:**
- Некоторые устройства показывают небольшое снижение среднего FPS, но **значительное улучшение стабильности FPS**
- Минимальный FPS улучшился на +6.99%
- 1% Перцентиль FPS улучшился на +1.88%
- Рекомендуемое действие: **Включить Vulkan** — улучшение стабильности FPS перевешивает незначительное снижение среднего FPS



Для каждой категории генерируются детальные таблицы с возможностью просмотра изменений по каждой группе устройств и по каждому игроку отдельно. Это позволяет принимать обоснованные решения на уровне конкретных моделей устройств и семейств GPU.

